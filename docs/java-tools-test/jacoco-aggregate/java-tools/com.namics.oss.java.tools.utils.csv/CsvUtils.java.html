<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../../jacoco-resources/report.gif" type="image/gif"/><title>CsvUtils.java</title><link rel="stylesheet" href="../../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../../index.html" class="el_report">java-tools-test</a> &gt; <a href="../index.html" class="el_bundle">java-tools</a> &gt; <a href="index.source.html" class="el_package">com.namics.oss.java.tools.utils.csv</a> &gt; <span class="el_source">CsvUtils.java</span></div><h1>CsvUtils.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2000-2015 Namics AG. All rights reserved.
 */

package com.namics.oss.java.tools.utils.csv;

import java.io.IOException;
import java.io.OutputStream;
import java.util.List;

/**
 * Utils to support writing to csv files.
 *
 * @author lboesch, Namics AG
 * @since 14.08.15 09:28
 */
public abstract class CsvUtils {
<span class="nc" id="L18">	protected static final CsvWriter writer = new CsvWriter();</span>
	private static final String SUPER_CSV = &quot;&lt;dependency&gt;\n&quot;
	                                        + &quot;    &lt;groupId&gt;net.sf.supercsv&lt;/groupId&gt;\n&quot;
	                                        + &quot;    &lt;artifactId&gt;super-csv&lt;/artifactId&gt;\n&quot;
	                                        + &quot;    &lt;version&gt;2.3.1&lt;/version&gt;\n&quot;
	                                        + &quot;&lt;/dependency&gt;&quot;;


	private CsvUtils() {
	}

	/**
	 * Write a list of bean to csv file, support for csv only.
	 *
	 * @param beans        beans to write to an excel sheet
	 * @param outputStream output stream to write the excel sheet
	 * @param ignores      list of properties to be ignored on writing
	 */
	public static void write(List&lt;?&gt; beans, OutputStream outputStream, String... ignores) throws IOException {
<span class="nc" id="L37">		checkAvailability();</span>
<span class="nc" id="L38">		writer.write(beans, outputStream, null, ignores);</span>
<span class="nc" id="L39">	}</span>

	/**
	 * Write a list of bean to csv file, support for csv only.
	 *
	 * @param beans        beans to write to an excel sheet
	 * @param outputStream output stream to write the excel sheet
	 * @param ignores      list of properties to be ignored on writing
	 */
	public static void write(List&lt;?&gt; beans, OutputStream outputStream, int delimiterChar, String... ignores) throws IOException {
<span class="nc" id="L49">		checkAvailability();</span>
<span class="nc" id="L50">		writer.write(beans, outputStream, delimiterChar, ignores);</span>
<span class="nc" id="L51">	}</span>

	/**
	 * Write a list of bean to csv file, support for csv only.
	 * only write bean properties, which are in &lt;code&gt;headers&lt;/code&gt; array.
	 *
	 * @param beans        beans to write to an excel sheet
	 * @param outputStream output stream to write the excel sheet
	 * @param headers      list of properties as header, also useful for ordered list
	 */
	public static void writeWithHeaders(List&lt;?&gt; beans, OutputStream outputStream, String... headers) throws IOException {
<span class="nc" id="L62">		checkAvailability();</span>
<span class="nc" id="L63">		writer.writeWithHeaders(beans, outputStream, null, headers);</span>
<span class="nc" id="L64">	}</span>

	/**
	 * Write a list of bean to csv file, support for csv only.
	 * only write bean properties, which are in &lt;code&gt;headers&lt;/code&gt; array.
	 *
	 * @param beans        beans to write to an excel sheet
	 * @param outputStream output stream to write the excel sheet
	 * @param headers      list of properties as header, also useful for ordered list
	 */
	public static void writeWithHeaders(List&lt;?&gt; beans, OutputStream outputStream, int delimiterChar, String... headers) throws IOException {
<span class="nc" id="L75">		checkAvailability();</span>
<span class="nc" id="L76">		writer.writeWithHeaders(beans, outputStream, delimiterChar, headers);</span>
<span class="nc" id="L77">	}</span>

	public static void checkAvailability() {
		try {
<span class="nc" id="L81">			Class.forName(&quot;org.supercsv.util.CsvContext&quot;, false, CsvUtils.class.getClassLoader());</span>
<span class="nc" id="L82">		} catch (ClassNotFoundException e) {</span>
<span class="nc" id="L83">			throw new IllegalArgumentException(&quot;To use CSV functions you must add super csv to your classpath: \n&quot; + SUPER_CSV, e);</span>
<span class="nc" id="L84">		}</span>

<span class="nc" id="L86">	}</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.0.201801022044</span></div></body></html>